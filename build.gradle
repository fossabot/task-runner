plugins {
    id 'checkstyle'
    id 'com.github.spotbugs' version '4.0.5'
}

allprojects {
    version = '1.0.0'
}

subprojects {
    apply plugin: 'java'
    apply plugin: 'checkstyle'
    apply plugin: 'com.github.spotbugs'
    java {
        repositories {
            mavenCentral()
        }
        sourceCompatibility = JavaVersion.VERSION_11
        targetCompatibility = JavaVersion.VERSION_11
        jar {
            archiveBaseName.set('task-runner')
        }
        dependencies {
            testImplementation group: 'org.junit.jupiter', name: 'junit-jupiter-api', version: '5.6.1'
            testImplementation group: 'org.junit.jupiter', name: 'junit-jupiter-engine', version: '5.6.1'
            testImplementation group: 'com.tngtech.archunit', name: 'archunit', version: '0.13.1'
            testImplementation group: 'com.tngtech.archunit', name: 'archunit-junit5-api', version: '0.13.1'
            testImplementation group: 'com.tngtech.archunit', name: 'archunit-junit5-engine', version: '0.13.1'
        }
        test {
            useJUnitPlatform()
        }
        spotbugs {
            excludeFilter.set(file("${project.rootDir}/config/spotbugs/spotbugs-exclude.xml"))
        }
        spotbugsMain {
            reports {
                html {
                    enabled = true
                    destination = file("$buildDir/reports/spotbugs/main.html")
                    stylesheet = 'fancy-hist.xsl'
                }
            }
        }
        spotbugsTest {
            reports {
                html {
                    enabled = true
                    destination = file("$buildDir/reports/spotbugs/test.html")
                    stylesheet = 'fancy-hist.xsl'
                }
            }
        }
    }
}
